"use strict";var app=angular.module("myApp",["ui.router","satellizer"]);app.config(["$authProvider",function(e){e.loginUrl="api/users/login",e.signupUrl="api/users/signup",e.facebook({clientId:"255060128209165",url:"/api/users/facebook"})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("home",{url:"/",templateUrl:"/html/home.html"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}).state("register",{url:"/register",templateUrl:"/html/register.html",controller:"registerCtrl"}).state("profile",{url:"/profile/:userId",templateUrl:"/html/profile.html",controller:"profileCtrl",resolve:{Profile:["User",function(e){return e.profile()}],ProfileByID:["User","$stateParams",function(e,o){return e.getProfile(o.userId)}]}}).state("users",{url:"/users",templateUrl:"/html/users.html",controller:"usersCtrl"}).state("cruds",{url:"/cruds",templateUrl:"html/cruds.html",controller:"crudsCtrl"}),o.otherwise("/")}]);var app=angular.module("myApp");app.controller("loginCtrl",["$scope","$state","$auth","$rootScope",function(e,o,t,r){console.log("loginCtrl!"),e.login=function(){t.login(e.user).then(function(e){console.log("res: ",e),o.go("profile")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("mainCtrl",["$scope","$state","$auth","$rootScope",function(e,o,t,r){console.log("mainCtrl!"),r.currentUser,e.isAuthenticated=function(){return t.isAuthenticated()},e.logout=function(){t.logout(),o.go("home")},e.authenticate=function(e){t.authenticate(e).then(function(e){o.go("home")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("profileCtrl",["$scope","Profile","ProfileByID","$state","User","$rootScope",function(e,o,t,r,n,l){console.log("profileCtrl!"),l.currentUser=o,e.user=t||o,console.log("user:",e.user),console.log("curruser:",l.currentUser),e.showdisplayNameForm=function(){console.log("show form"),e.displayNameForm=!0},e.updatedisplayName=function(){e.displayNameForm=!1,e.user.displayName=e.newItem.displayName,n.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.displayName=""})["catch"](function(e){console.log("err:",e)})},e.canceldisplayName=function(){e.usernameForm=!0,e.newItem.displayName=""},e.showPictureForm=function(){console.log("show form"),e.photoForm=!0},e.updatePicture=function(){e.photoForm=!1,console.log("$state.current: ",r.current),e.user.profileImage=e.newItem.profileImage,console.log("$scope.newItem:",e.newItem),n.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.profileImage=""})["catch"](function(e){console.log("err:",e)})},e.cancelPhotoUrl=function(){e.photoForm=!0,e.newItem.photoUrl=""},e.deleteAccount=function(e){console.log(e._id),n.deleteAccount(e._id).then()["catch"](function(e){console.log("err: ",e)})}}]);var app=angular.module("myApp");app.controller("registerCtrl",["$scope","$state","$auth",function(e,o,t){console.log("registerCtrl!"),e.register=function(){e.user.password!==e.user.password2?(e.user.password=null,e.user.password2=null,alert("Passwords must match!")):t.signup(e.user).then(function(e){console.log("res: ",e),o.go("login")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("usersCtrl",["$scope","$$state","$state","User",function(e,o,t,r){console.log("usersCtrl!");var n=r.getAll();console.log("userPromise:",n),n.then(function(o){console.log(o.data),e.userFeed=o.data})}]);var app=angular.module("myApp");app.service("Crud",["$http","$q",function(e,o){this.getAll=function(){return e.get("/api/cruds")},this.getById=function(o){return e.get("/api/cruds/"+o)},this.addCrud=function(t){return e.post("/api/cruds",crud).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.deleteCrud=function(t){return e["delete"]("/api/cruds/"+t).then(function(){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.updateCrud=function(t,r){return e.put("/api/cruds/"+t,r).then(function(e){return o.resolve(r)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("User",["$http","$q",function(e,o){this.profile=function(){return e.get("/api/users/profile").then(function(e){return o.resolve(e.data)})},this.getProfile=function(t){return e.get("/api/users/profile/"+t).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getAll=function(){return e.get("/api/users")},this.updateProfile=function(t,r){return console.log("here"),console.log(t," ",r),e.put("/api/users/profile/"+t,r).then(function(e){return console.log("res.data",e.data),console.log("profileObj",r),o.resolve()})["catch"](function(e){console.log("err:",e)})},this.deleteAccount=function(t){return e["delete"]("/api/users/profile/"+t).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.addWallPostToUser=function(t,r){return console.log("userId: ",t," postId: ",r),e.put("/api/users/profile/"+t+"/addWallPost/"+r).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2xvZ2luQ3RybC5qcyIsImNvbnRyb2xsZXJzL21haW5DdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvZmlsZUN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3RlckN0cmwuanMiLCJjb250cm9sbGVycy91c2Vyc0N0cmwuanMiLCJzZXJ2aWNlcy9jcnVkc2VydmljZXMuanMiLCJzZXJ2aWNlcy91c2Vyc2VydmljZXMuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRhdXRoUHJvdmlkZXIiLCJsb2dpblVybCIsInNpZ251cFVybCIsImZhY2Vib29rIiwiY2xpZW50SWQiLCJ1cmwiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInN0YXRlIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwicmVzb2x2ZSIsIlByb2ZpbGUiLCJVc2VyIiwicHJvZmlsZSIsIlByb2ZpbGVCeUlEIiwiJHN0YXRlUGFyYW1zIiwiZ2V0UHJvZmlsZSIsInVzZXJJZCIsIm90aGVyd2lzZSIsIiRzY29wZSIsIiRzdGF0ZSIsIiRhdXRoIiwiJHJvb3RTY29wZSIsImNvbnNvbGUiLCJsb2ciLCJsb2dpbiIsInVzZXIiLCJ0aGVuIiwicmVzIiwiZ28iLCJlcnIiLCJjdXJyZW50VXNlciIsImlzQXV0aGVudGljYXRlZCIsImxvZ291dCIsImF1dGhlbnRpY2F0ZSIsInByb3ZpZGVyIiwic2hvd2Rpc3BsYXlOYW1lRm9ybSIsImRpc3BsYXlOYW1lRm9ybSIsInVwZGF0ZWRpc3BsYXlOYW1lIiwiZGlzcGxheU5hbWUiLCJuZXdJdGVtIiwidXBkYXRlUHJvZmlsZSIsIl9pZCIsImNhbmNlbGRpc3BsYXlOYW1lIiwidXNlcm5hbWVGb3JtIiwic2hvd1BpY3R1cmVGb3JtIiwicGhvdG9Gb3JtIiwidXBkYXRlUGljdHVyZSIsImN1cnJlbnQiLCJwcm9maWxlSW1hZ2UiLCJjYW5jZWxQaG90b1VybCIsInBob3RvVXJsIiwiZGVsZXRlQWNjb3VudCIsInJlZ2lzdGVyIiwicGFzc3dvcmQiLCJwYXNzd29yZDIiLCJhbGVydCIsInNpZ251cCIsIiQkc3RhdGUiLCJ1c2VyUHJvbWlzZSIsImdldEFsbCIsInJlc3VsdCIsImRhdGEiLCJ1c2VyRmVlZCIsInNlcnZpY2UiLCIkaHR0cCIsIiRxIiwidGhpcyIsImdldCIsImdldEJ5SWQiLCJpZCIsImFkZENydWQiLCJhcGFydG1lbnQiLCJwb3N0IiwiY3J1ZCIsImRlbGV0ZUNydWQiLCJ1cGRhdGVDcnVkIiwicHV0IiwicHJvZmlsZU9iaiIsImFkZFdhbGxQb3N0VG9Vc2VyIiwicG9zdElkIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUVBLElBQUlBLEtBQU1DLFFBQVFDLE9BQU8sU0FBVSxZQUFhLGNBRWhERixLQUFJRyxRQUFBLGdCQUFPLFNBQVNDLEdBRWxCQSxFQUFjQyxTQUFXLGtCQUN6QkQsRUFBY0UsVUFBWSxtQkFFMUJGLEVBQWNHLFVBQ1pDLFNBQVUsa0JBQ1ZDLElBQUssMkJBS1RULElBQUlHLFFBQUEsaUJBQUEscUJBQU8sU0FBU08sRUFBZ0JDLEdBRWxDRCxFQUNHRSxNQUFNLFFBQVVILElBQUssSUFBS0ksWUFBYSxvQkFDdkNELE1BQU0sU0FDTEgsSUFBSyxTQUNMSSxZQUFhLG1CQUNiQyxXQUFZLGNBRWJGLE1BQU0sWUFDTEgsSUFBSyxZQUNMSSxZQUFhLHNCQUNiQyxXQUFZLGlCQUViRixNQUFNLFdBQ0xILElBQUssbUJBQ0xJLFlBQWEscUJBQ2JDLFdBQVksY0FDWkMsU0FDRUMsU0FBQSxPQUFTLFNBQVNDLEdBQ2hCLE1BQU9BLEdBQUtDLFlBRWRDLGFBQUEsT0FBQSxlQUFhLFNBQVNGLEVBQU1HLEdBQzFCLE1BQU9ILEdBQUtJLFdBQVdELEVBQWFFLGFBSXpDVixNQUFNLFNBQ0xILElBQUssU0FDTEksWUFBYSxtQkFDYkMsV0FBWSxjQUViRixNQUFNLFNBQ0hILElBQUssU0FDTEksWUFBYSxrQkFDYkMsV0FBWSxjQUVsQkgsRUFBbUJZLFVB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QWdCLFNBQUNrQixHQUNwQixNQUFPTCxHQUFBQSxVQUFBLHNCQUFtQ0ssR0FDekMzQyxLQUFLLFNBQUFDLEdBQ0YsTUFBT3NDLEdBQUd4RCxZQUZQdUQsU0FJQSxTQUFBbkMsR0FDTFAsUUFBUUMsSUFBSSxPQUFRTSxNQUl4QnFDLEtBQUtZLGtCQUFvQixTQUFDOUQsRUFBUStELEdBRWhDLE1BREF6RCxTQUFRQyxJQUFJLFdBQVdQLEVBQVEsWUFBYStELEdBQ3JDZixFQUFNWSxJQUFOLHNCQUFnQzVELEVBQWhDLGdCQUFzRCtELEdBQzVEckQsS0FBSyxTQUFBQyxHQUNGLE1BQU9zQyxHQUFHeEQsUUFBUWtCLEVBQUlrQyxRQUZuQkcsU0FJQSxTQUFBbkMsR0FDSFAsUUFBUUMsSUFBSSxPQUFRTSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnLCBbJ3VpLnJvdXRlcicsICdzYXRlbGxpemVyJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRhdXRoUHJvdmlkZXIpIHtcblxuICAkYXV0aFByb3ZpZGVyLmxvZ2luVXJsID0gJ2FwaS91c2Vycy9sb2dpbic7XG4gICRhdXRoUHJvdmlkZXIuc2lnbnVwVXJsID0gJ2FwaS91c2Vycy9zaWdudXAnO1xuXG4gICRhdXRoUHJvdmlkZXIuZmFjZWJvb2soe1xuICAgIGNsaWVudElkOiAnMjU1MDYwMTI4MjA5MTY1JyxcbiAgICB1cmw6ICcvYXBpL3VzZXJzL2ZhY2Vib29rJ1xuICB9KTtcblxufSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICRzdGF0ZVByb3ZpZGVyXG4gICAgLnN0YXRlKCdob21lJywgeyB1cmw6ICcvJywgdGVtcGxhdGVVcmw6ICcvaHRtbC9ob21lLmh0bWwnIH0pXG4gICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL2xvZ2luLmh0bWwnLFxuICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICB9KVxuICAgIC5zdGF0ZSgncmVnaXN0ZXInLCB7XG4gICAgICB1cmw6ICcvcmVnaXN0ZXInLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9yZWdpc3Rlci5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdyZWdpc3RlckN0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG4gICAgICB1cmw6ICcvcHJvZmlsZS86dXNlcklkJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcHJvZmlsZS5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdwcm9maWxlQ3RybCcsXG4gICAgICByZXNvbHZlOiB7XG4gICAgICAgIFByb2ZpbGU6IGZ1bmN0aW9uKFVzZXIpIHtcbiAgICAgICAgICByZXR1cm4gVXNlci5wcm9maWxlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIFByb2ZpbGVCeUlEOiBmdW5jdGlvbihVc2VyLCAkc3RhdGVQYXJhbXMpe1xuICAgICAgICAgIHJldHVybiBVc2VyLmdldFByb2ZpbGUoJHN0YXRlUGFyYW1zLnVzZXJJZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICAgIC5zdGF0ZSgndXNlcnMnLCB7XG4gICAgICB1cmw6ICcvdXNlcnMnLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC91c2Vycy5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICd1c2Vyc0N0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ2NydWRzJywge1xuICAgICAgICB1cmw6ICcvY3J1ZHMnLCBcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdodG1sL2NydWRzLmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyOiAnY3J1ZHNDdHJsJ1xuICAgICAgfSlcbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xufSk7XG5cbiIsIlxuJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgJGF1dGgsICRyb290U2NvcGUpIHtcbiAgY29uc29sZS5sb2coJ2xvZ2luQ3RybCEnKTtcblxuICAkc2NvcGUubG9naW4gPSAoKSA9PiB7XG4gICAgICAkYXV0aC5sb2dpbigkc2NvcGUudXNlcilcbiAgICAgIC50aGVuKHJlcyA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXM6IFwiLCByZXMpO1xuICAgICAgICAvLyRyb290U2NvcGUuY3VycmVudFVzZXIgPSByZXMuZGF0YTtcbiAgICAgICAgJHN0YXRlLmdvKCdwcm9maWxlJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICB9KVxuICAgIH07XG59KTsiLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsICRhdXRoLCAkcm9vdFNjb3BlKSB7XG4gIGNvbnNvbGUubG9nKCdtYWluQ3RybCEnKTtcblxuICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyO1xuXG4gICRzY29wZS5pc0F1dGhlbnRpY2F0ZWQgPSAoKSA9PiAkYXV0aC5pc0F1dGhlbnRpY2F0ZWQoKTtcblxuICAkc2NvcGUubG9nb3V0ID0gKCkgPT4ge1xuICAgICRhdXRoLmxvZ291dCgpO1xuICAgICRzdGF0ZS5nbygnaG9tZScpO1xuICB9O1xuXG4gICRzY29wZS5hdXRoZW50aWNhdGUgPSBwcm92aWRlciA9PiB7XG4gICAgJGF1dGguYXV0aGVudGljYXRlKHByb3ZpZGVyKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gIH07XG59KTtcbiIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcigncHJvZmlsZUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFByb2ZpbGUsIFByb2ZpbGVCeUlELCAkc3RhdGUsIFVzZXIsICRyb290U2NvcGUpIHtcbiAgXG4gIGNvbnNvbGUubG9nKCdwcm9maWxlQ3RybCEnKTtcblxuICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gUHJvZmlsZTtcblxuICAkc2NvcGUudXNlciA9IFByb2ZpbGVCeUlEIHx8IFByb2ZpbGU7XG5cbiAgY29uc29sZS5sb2coXCJ1c2VyOlwiLCAkc2NvcGUudXNlciApO1xuICBjb25zb2xlLmxvZyhcImN1cnJ1c2VyOlwiLCAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyICk7XG5cbiAgJHNjb3BlLnNob3dkaXNwbGF5TmFtZUZvcm0gPSAoKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInNob3cgZm9ybVwiKTtcbiAgICAkc2NvcGUuZGlzcGxheU5hbWVGb3JtID0gdHJ1ZTtcbiAgfVxuXG4gICRzY29wZS51cGRhdGVkaXNwbGF5TmFtZSA9ICgpID0+IHtcbiAgICAkc2NvcGUuZGlzcGxheU5hbWVGb3JtID0gZmFsc2U7XG4gICAgJHNjb3BlLnVzZXIuZGlzcGxheU5hbWUgPSAkc2NvcGUubmV3SXRlbS5kaXNwbGF5TmFtZTtcbiAgICBVc2VyLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLnVzZXIuX2lkLCAkc2NvcGUubmV3SXRlbSlcbiAgICAgIC50aGVuKHByb2ZpbGUgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZTpcIiwgcHJvZmlsZSk7XG4gICAgICAgICRzY29wZS5uZXdJdGVtLmRpc3BsYXlOYW1lID0gJyc7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgICB9KVxuICB9XG5cbiAgJHNjb3BlLmNhbmNlbGRpc3BsYXlOYW1lID0gKCkgPT57XG4gICAgJHNjb3BlLnVzZXJuYW1lRm9ybSA9IHRydWU7XG4gICAgJHNjb3BlLm5ld0l0ZW0uZGlzcGxheU5hbWUgPSAnJztcbiAgfVxuXG4vL3Bob3RvXG4gICRzY29wZS5zaG93UGljdHVyZUZvcm0gPSAoKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInNob3cgZm9ybVwiKTtcbiAgICAkc2NvcGUucGhvdG9Gb3JtID0gdHJ1ZTtcbiAgfVxuXG4gICRzY29wZS51cGRhdGVQaWN0dXJlID0gKCkgPT4ge1xuICAgICRzY29wZS5waG90b0Zvcm0gPSBmYWxzZTtcbiAgICBjb25zb2xlLmxvZyhcIiRzdGF0ZS5jdXJyZW50OiBcIiwgJHN0YXRlLmN1cnJlbnQpO1xuICAgICRzY29wZS51c2VyLnByb2ZpbGVJbWFnZSA9ICRzY29wZS5uZXdJdGVtLnByb2ZpbGVJbWFnZTtcbiAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5uZXdJdGVtOlwiLCAkc2NvcGUubmV3SXRlbSk7XG4gICAgVXNlci51cGRhdGVQcm9maWxlKCRzY29wZS51c2VyLl9pZCwgJHNjb3BlLm5ld0l0ZW0pXG4gICAgICAudGhlbihwcm9maWxlID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInByb2ZpbGU6XCIsIHByb2ZpbGUpO1xuICAgICAgICAkc2NvcGUubmV3SXRlbS5wcm9maWxlSW1hZ2UgPSAnJztcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICAkc2NvcGUuY2FuY2VsUGhvdG9VcmwgPSAoKSA9PntcbiAgICAkc2NvcGUucGhvdG9Gb3JtID0gdHJ1ZTtcbiAgICAkc2NvcGUubmV3SXRlbS5waG90b1VybCA9ICcnO1xuICB9XG5cblxuICAkc2NvcGUuZGVsZXRlQWNjb3VudCA9ICh1c2VyKSA9PntcbiAgICAvL2FkZCBzd2FsXG4gICAgY29uc29sZS5sb2codXNlci5faWQpO1xuICAgIFVzZXIuZGVsZXRlQWNjb3VudCh1c2VyLl9pZClcbiAgICAgIC50aGVuKClcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOiBcIiwgZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cblxufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdyZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgJGF1dGgpIHtcbiAgY29uc29sZS5sb2coJ3JlZ2lzdGVyQ3RybCEnKTtcblxuICAkc2NvcGUucmVnaXN0ZXIgPSAoKSA9PiB7XG4gICAgaWYoJHNjb3BlLnVzZXIucGFzc3dvcmQgIT09ICRzY29wZS51c2VyLnBhc3N3b3JkMil7XG4gICAgICAkc2NvcGUudXNlci5wYXNzd29yZCA9IG51bGw7XG4gICAgICAkc2NvcGUudXNlci5wYXNzd29yZDIgPSBudWxsO1xuICAgICAgYWxlcnQoJ1Bhc3N3b3JkcyBtdXN0IG1hdGNoIScpO1xuICAgIH1lbHNle1xuICAgICAgJGF1dGguc2lnbnVwKCRzY29wZS51c2VyKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlczogXCIsIHJlcyk7XG4gICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gICAgfVxuICB9O1xufSk7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCd1c2Vyc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICQkc3RhdGUsICRzdGF0ZSwgVXNlcikge1xuICBjb25zb2xlLmxvZygndXNlcnNDdHJsIScpO1xuXG4gIHZhciB1c2VyUHJvbWlzZSA9IFVzZXIuZ2V0QWxsKCk7XG4gIGNvbnNvbGUubG9nKFwidXNlclByb21pc2U6XCIsIHVzZXJQcm9taXNlKTtcbiAgdXNlclByb21pc2UudGhlbihcbiAgICBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQuZGF0YSk7XG4gICAgICAgJHNjb3BlLnVzZXJGZWVkID0gcmVzdWx0LmRhdGE7XG4gICAgfSk7XG5cblxuXG59KTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLnNlcnZpY2UoJ0NydWQnLCBmdW5jdGlvbigkaHR0cCwgJHEpe1xuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS9jcnVkcycpO1xuICB9XG5cbiAgdGhpcy5nZXRCeUlkID0gaWQgPT57XG4gICAgcmV0dXJuICRodHRwLmdldChgL2FwaS9jcnVkcy8ke2lkfWApO1xuICB9XG5cbiAgdGhpcy5hZGRDcnVkPSAoYXBhcnRtZW50KSA9PntcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9jcnVkc2AsIGNydWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuICB0aGlzLmRlbGV0ZUNydWQgPSAoaWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5kZWxldGUoYC9hcGkvY3J1ZHMvJHtpZH1gKVxuICAgICAgLnRoZW4oICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG4gIHRoaXMudXBkYXRlQ3J1ZCA9IChpZCwgY3J1ZCkgPT57XG4gICAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL2NydWRzLyR7aWR9YCwgY3J1ZClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKGNydWQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cbn0pO1xuXG4vL2luIHJlc2lkZW50cyBSZXNpZGVudC5nZXRBbGwoKVxuLy8gICAgICAgICAgICAgICAgLnRoZW4ocmVzaWRlbnRzID0+e30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdVc2VyJywgZnVuY3Rpb24oJGh0dHAsICRxKSB7XG5cbiAgdGhpcy5wcm9maWxlID0gKCkgPT4ge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcHJvZmlsZScpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KTtcbiAgfTtcblxuICB0aGlzLmdldFByb2ZpbGUgPSAoaWQpID0+e1xuICAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpO1xuICB9XG5cbiAgdGhpcy51cGRhdGVQcm9maWxlID0gKGlkLCBwcm9maWxlT2JqKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImhlcmVcIik7XG4gICAgY29uc29sZS5sb2coaWQgLCBcIiBcIiAscHJvZmlsZU9iaik7XG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YCwgIHByb2ZpbGVPYmopXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMuZGF0YVwiLCByZXMuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZU9ialwiLCBwcm9maWxlT2JqKTtcblxuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5kZWxldGVBY2NvdW50ID0gKGlkKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZGVsZXRlKGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmFkZFdhbGxQb3N0VG9Vc2VyID0gKHVzZXJJZCwgcG9zdElkKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInVzZXJJZDogXCIsdXNlcklkICxcIiBwb3N0SWQ6IFwiLCBwb3N0SWQpXG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7dXNlcklkfS9hZGRXYWxsUG9zdC8ke3Bvc3RJZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgfSlcbiAgfTsgXG5cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
