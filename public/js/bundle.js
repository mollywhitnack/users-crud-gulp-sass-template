"use strict";var app=angular.module("myApp",["ui.router","satellizer"]);app.config(["$authProvider",function(e){e.loginUrl="api/users/login",e.signupUrl="api/users/signup",e.facebook({clientId:"255060128209165",url:"/api/users/facebook"})}]),app.config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("home",{url:"/",templateUrl:"/html/home.html"}).state("login",{url:"/login",templateUrl:"/html/login.html",controller:"loginCtrl"}).state("register",{url:"/register",templateUrl:"/html/register.html",controller:"registerCtrl"}).state("profile",{url:"/profile/:userId",templateUrl:"/html/profile.html",controller:"profileCtrl",resolve:{Profile:["User",function(e){return e.profile()}],ProfileByID:["User","$stateParams",function(e,o){return e.getProfile(o.userId)}]}}).state("users",{url:"/users",templateUrl:"/html/users.html",controller:"usersCtrl"}).state("cruds",{url:"/cruds",templateUrl:"html/cruds.html",controller:"crudCtrl"}),o.otherwise("/")}]);var app=angular.module("myApp");app.controller("crudCtrl",["$scope","Crud",function(e,o){e.cruds=[],o.getAll().then(function(o){e.cruds=o.data,console.log("$scope.cruds:",e.cruds)})["catch"](function(e){console.log("err: ",e)}),e.addCrud=function(){o.addCrud(e.newItem).then(function(o){e.cruds.push(o),e.newItem={}})["catch"](function(e){console.log("error: ",e)})},e.deleteCrud=function(t,r){console.log("crud:",r),o.deleteCrud(r._id).then(function(o){e.cruds.splice(t,1)})["catch"](function(e){console.log("error: ",e)})},e.showUpdateForm=function(o,t){console.log("index: ",o),console.log("crud: ",t),e.showUpdate=!0,e.updateItem=t,e.updateIndex=o},e.updateCrud=function(){e.showUpdate=!1,o.updateCrud(e.updateItem._id,e.updateItem).then(function(o){console.log("update apt:",e.updateItem._id," , ",e.updateItem)})["catch"](function(e){console.log("error: ",e)})}}]);var app=angular.module("myApp");app.controller("loginCtrl",["$scope","$state","$auth","$rootScope",function(e,o,t,r){console.log("loginCtrl!"),e.login=function(){t.login(e.user).then(function(e){console.log("res: ",e),o.go("profile")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("mainCtrl",["$scope","$state","$auth","$rootScope",function(e,o,t,r){console.log("mainCtrl!"),r.currentUser,e.isAuthenticated=function(){return t.isAuthenticated()},e.logout=function(){t.logout(),o.go("home")},e.authenticate=function(e){t.authenticate(e).then(function(e){o.go("home")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("profileCtrl",["$scope","Profile","ProfileByID","$state","User","$rootScope",function(e,o,t,r,n,l){console.log("profileCtrl!"),l.currentUser=o,e.user=t||o,console.log("user:",e.user),console.log("curruser:",l.currentUser),e.showdisplayNameForm=function(){console.log("show form"),e.displayNameForm=!0},e.updatedisplayName=function(){e.displayNameForm=!1,e.user.displayName=e.newItem.displayName,n.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.displayName=""})["catch"](function(e){console.log("err:",e)})},e.canceldisplayName=function(){e.usernameForm=!0,e.newItem.displayName=""},e.showPictureForm=function(){console.log("show form"),e.photoForm=!0},e.updatePicture=function(){e.photoForm=!1,console.log("$state.current: ",r.current),e.user.profileImage=e.newItem.profileImage,console.log("$scope.newItem:",e.newItem),n.updateProfile(e.user._id,e.newItem).then(function(o){console.log("profile:",o),e.newItem.profileImage=""})["catch"](function(e){console.log("err:",e)})},e.cancelPhotoUrl=function(){e.photoForm=!0,e.newItem.photoUrl=""},e.deleteAccount=function(e){console.log(e._id),n.deleteAccount(e._id).then()["catch"](function(e){console.log("err: ",e)})}}]);var app=angular.module("myApp");app.controller("registerCtrl",["$scope","$state","$auth",function(e,o,t){console.log("registerCtrl!"),e.register=function(){e.user.password!==e.user.password2?(e.user.password=null,e.user.password2=null,alert("Passwords must match!")):t.signup(e.user).then(function(e){console.log("res: ",e),o.go("login")})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.controller("usersCtrl",["$scope","$$state","$state","User",function(e,o,t,r){console.log("usersCtrl!");var n=r.getAll();console.log("userPromise:",n),n.then(function(o){console.log(o.data),e.userFeed=o.data})}]);var app=angular.module("myApp");app.service("Crud",["$http","$q",function(e,o){this.getAll=function(){return e.get("/api/cruds")},this.getById=function(o){return e.get("/api/cruds/"+o)},this.addCrud=function(t){return e.post("/api/cruds",t).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.deleteCrud=function(t){return e["delete"]("/api/cruds/"+t).then(function(){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.updateCrud=function(t,r){return e.put("/api/cruds/"+t,r).then(function(e){return o.resolve(r)})["catch"](function(e){console.log("err:",e)})}}]);var app=angular.module("myApp");app.service("User",["$http","$q",function(e,o){this.profile=function(){return e.get("/api/users/profile").then(function(e){return o.resolve(e.data)})},this.getProfile=function(t){return e.get("/api/users/profile/"+t).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})},this.getAll=function(){return e.get("/api/users")},this.updateProfile=function(t,r){return console.log("here"),console.log(t," ",r),e.put("/api/users/profile/"+t,r).then(function(e){return console.log("res.data",e.data),console.log("profileObj",r),o.resolve()})["catch"](function(e){console.log("err:",e)})},this.deleteAccount=function(t){return e["delete"]("/api/users/profile/"+t).then(function(e){return o.resolve()})["catch"](function(e){console.log("err:",e)})},this.addWallPostToUser=function(t,r){return console.log("userId: ",t," postId: ",r),e.put("/api/users/profile/"+t+"/addWallPost/"+r).then(function(e){return o.resolve(e.data)})["catch"](function(e){console.log("err:",e)})}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2NydWRDdHJsLmpzIiwiY29udHJvbGxlcnMvbG9naW5DdHJsLmpzIiwiY29udHJvbGxlcnMvbWFpbkN0cmwuanMiLCJjb250cm9sbGVycy9wcm9maWxlQ3RybC5qcyIsImNvbnRyb2xsZXJzL3JlZ2lzdGVyQ3RybC5qcyIsImNvbnRyb2xsZXJzL3VzZXJzQ3RybC5qcyIsInNlcnZpY2VzL2NydWRzZXJ2aWNlcy5qcyIsInNlcnZpY2VzL3VzZXJzZXJ2aWNlcy5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGF1dGhQcm92aWRlciIsImxvZ2luVXJsIiwic2lnbnVwVXJsIiwiZmFjZWJvb2siLCJjbGllbnRJZCIsInVybCIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwic3RhdGUiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJyZXNvbHZlIiwiUHJvZmlsZSIsIlVzZXIiLCJwcm9maWxlIiwiUHJvZmlsZUJ5SUQiLCIkc3RhdGVQYXJhbXMiLCJnZXRQcm9maWxlIiwidXNlcklkIiwib3RoZXJ3aXNlIiwiJHNjb3BlIiwiQ3J1ZCIsImNydWRzIiwiZ2V0QWxsIiwidGhlbiIsInJlcyIsImRhdGEiLCJjb25zb2xlIiwibG9nIiwiZXJyIiwiYWRkQ3J1ZCIsIm5ld0l0ZW0iLCJjcnVkIiwicHVzaCIsImRlbGV0ZUNydWQiLCJpbmQiLCJfaWQiLCJzcGxpY2UiLCJzaG93VXBkYXRlRm9ybSIsImluZGV4Iiwic2hvd1VwZGF0ZSIsInVwZGF0ZUl0ZW0iLCJ1cGRhdGVJbmRleCIsInVwZGF0ZUNydWQiLCIkc3RhdGUiLCIkYXV0aCIsIiRyb290U2NvcGUiLCJsb2dpbiIsInVzZXIiLCJnbyIsImN1cnJlbnRVc2VyIiwiaXNBdXRoZW50aWNhdGVkIiwibG9nb3V0IiwiYXV0aGVudGljYXRlIiwicHJvdmlkZXIiLCJzaG93ZGlzcGxheU5hbWVGb3JtIiwiZGlzcGxheU5hbWVGb3JtIiwidXBkYXRlZGlzcGxheU5hbWUiLCJkaXNwbGF5TmFtZSIsInVwZGF0ZVByb2ZpbGUiLCJjYW5jZWxkaXNwbGF5TmFtZSIsInVzZXJuYW1lRm9ybSIsInNob3dQaWN0dXJlRm9ybSIsInBob3RvRm9ybSIsInVwZGF0ZVBpY3R1cmUiLCJjdXJyZW50IiwicHJvZmlsZUltYWdlIiwiY2FuY2VsUGhvdG9VcmwiLCJwaG90b1VybCIsImRlbGV0ZUFjY291bnQiLCJyZWdpc3RlciIsInBhc3N3b3JkIiwicGFzc3dvcmQyIiwiYWxlcnQiLCJzaWdudXAiLCIkJHN0YXRlIiwidXNlclByb21pc2UiLCJyZXN1bHQiLCJ1c2VyRmVlZCIsInNlcnZpY2UiLCIkaHR0cCIsIiRxIiwidGhpcyIsImdldCIsImdldEJ5SWQiLCJpZCIsInBvc3QiLCJwdXQiLCJwcm9maWxlT2JqIiwiYWRkV2FsbFBvc3RUb1VzZXIiLCJwb3N0SWQiXSwibWFwcGluZ3MiOiJBQUFBLFlBRUEsSUFBSUEsS0FBTUMsUUFBUUMsT0FBTyxTQUFVLFlBQWEsY0FFaERGLEtBQUlHLFFBQUEsZ0JBQU8sU0FBU0MsR0FFbEJBLEVBQWNDLFNBQVcsa0JBQ3pCRCxFQUFjRSxVQUFZLG1CQUUxQkYsRUFBY0csVUFDWkMsU0FBVSxrQkFDVkMsSUFBSywyQkFLVFQsSUFBSUcsUUFBQSxpQkFBQSxxQkFBTyxTQUFTTyxFQUFnQkMsR0FFbENELEVBQ0dFLE1BQU0sUUFBVUgsSUFBSyxJQUFLSSxZQUFhLG9CQUN2Q0QsTUFBTSxTQUNMSCxJQUFLLFNBQ0xJLFlBQWEsbUJBQ2JDLFdBQVksY0FFYkYsTUFBTSxZQUNMSCxJQUFLLFlBQ0xJLFlBQWEsc0JBQ2JDLFdBQVksaUJBRWJGLE1BQU0sV0FDTEgsSUFBSyxtQkFDTEksWUFBYSxxQkFDYkMsV0FBWSxjQUNaQyxTQUNFQyxTQUFBLE9BQVMsU0FBU0MsR0FDaEIsTUFBT0EsR0FBS0MsWUFFZEMsYUFBQSxPQUFBLGVBQWEsU0FBU0YsRUFBTUcsR0FDMUIsTUFBT0gsR0FBS0ksV0FB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R0FJRixNQUhBRSxTQUFRQyxJQUFJLFdBQVlILEVBQUlDLE1BQzVCQyxRQUFRQyxJQUFJLGFBQWM0RCxHQUVuQlAsRUFBR3RFLFlBTFBxRSxTQU9BLFNBQUFuRCxHQUNMRixRQUFRQyxJQUFJLE9BQVFDLE1BSXhCcUQsS0FBS2IsY0FBZ0IsU0FBQ2dCLEdBQ3BCLE1BQU9MLEdBQUFBLFVBQUEsc0JBQW1DSyxHQUN6QzdELEtBQUssU0FBQUMsR0FDRixNQUFPd0QsR0FBR3RFLFlBRlBxRSxTQUlBLFNBQUFuRCxHQUNMRixRQUFRQyxJQUFJLE9BQVFDLE1BSXhCcUQsS0FBS08sa0JBQW9CLFNBQUN2RSxFQUFRd0UsR0FFaEMsTUFEQS9ELFNBQVFDLElBQUksV0FBV1YsRUFBUSxZQUFhd0UsR0FDckNWLEVBQU1PLElBQU4sc0JBQWdDckUsRUFBaEMsZ0JBQXNEd0UsR0FDNURsRSxLQUFLLFNBQUFDLEdBQ0YsTUFBT3dELEdBQUd0RSxRQUFRYyxFQUFJQyxRQUZuQnNELFNBSUEsU0FBQW5ELEdBQ0hGLFFBQVFDLElBQUksT0FBUUMiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJywgWyd1aS5yb3V0ZXInLCAnc2F0ZWxsaXplciddKTtcblxuYXBwLmNvbmZpZyhmdW5jdGlvbigkYXV0aFByb3ZpZGVyKSB7XG5cbiAgJGF1dGhQcm92aWRlci5sb2dpblVybCA9ICdhcGkvdXNlcnMvbG9naW4nO1xuICAkYXV0aFByb3ZpZGVyLnNpZ251cFVybCA9ICdhcGkvdXNlcnMvc2lnbnVwJztcblxuICAkYXV0aFByb3ZpZGVyLmZhY2Vib29rKHtcbiAgICBjbGllbnRJZDogJzI1NTA2MDEyODIwOTE2NScsXG4gICAgdXJsOiAnL2FwaS91c2Vycy9mYWNlYm9vaydcbiAgfSk7XG5cbn0pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuICAkc3RhdGVQcm92aWRlclxuICAgIC5zdGF0ZSgnaG9tZScsIHsgdXJsOiAnLycsIHRlbXBsYXRlVXJsOiAnL2h0bWwvaG9tZS5odG1sJyB9KVxuICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgdGVtcGxhdGVVcmw6ICcvaHRtbC9sb2dpbi5odG1sJyxcbiAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXG4gICAgfSlcbiAgICAuc3RhdGUoJ3JlZ2lzdGVyJywge1xuICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvcmVnaXN0ZXIuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAncmVnaXN0ZXJDdHJsJ1xuICAgIH0pXG4gICAgLnN0YXRlKCdwcm9maWxlJywge1xuICAgICAgdXJsOiAnL3Byb2ZpbGUvOnVzZXJJZCcsXG4gICAgICB0ZW1wbGF0ZVVybDogJy9odG1sL3Byb2ZpbGUuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAncHJvZmlsZUN0cmwnLFxuICAgICAgcmVzb2x2ZToge1xuICAgICAgICBQcm9maWxlOiBmdW5jdGlvbihVc2VyKSB7XG4gICAgICAgICAgcmV0dXJuIFVzZXIucHJvZmlsZSgpO1xuICAgICAgICB9LFxuICAgICAgICBQcm9maWxlQnlJRDogZnVuY3Rpb24oVXNlciwgJHN0YXRlUGFyYW1zKXtcbiAgICAgICAgICByZXR1cm4gVXNlci5nZXRQcm9maWxlKCRzdGF0ZVBhcmFtcy51c2VySWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgICAuc3RhdGUoJ3VzZXJzJywge1xuICAgICAgdXJsOiAnL3VzZXJzJyxcbiAgICAgIHRlbXBsYXRlVXJsOiAnL2h0bWwvdXNlcnMuaHRtbCcsXG4gICAgICBjb250cm9sbGVyOiAndXNlcnNDdHJsJ1xuICAgIH0pXG4gICAgLnN0YXRlKCdjcnVkcycsIHtcbiAgICAgICAgdXJsOiAnL2NydWRzJywgXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9jcnVkcy5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ2NydWRDdHJsJ1xuICAgICAgfSlcbiAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xufSk7XG5cbiIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignY3J1ZEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIENydWQpIHtcblxuICAkc2NvcGUuY3J1ZHMgPSBbXTtcblxuICBDcnVkLmdldEFsbCgpXG4gIC50aGVuKHJlcyA9PntcbiAgICAkc2NvcGUuY3J1ZHMgPSByZXMuZGF0YTtcbiAgICBjb25zb2xlLmxvZyhcIiRzY29wZS5jcnVkczpcIiwgJHNjb3BlLmNydWRzKTtcbiAgfSlcbiAgLmNhdGNoKGVyciA9PntcbiAgICBjb25zb2xlLmxvZyhcImVycjogXCIsIGVycik7XG4gIH0pXG5cbiAgJHNjb3BlLmFkZENydWQgPSAoKSA9PntcbiAgICBDcnVkLmFkZENydWQoJHNjb3BlLm5ld0l0ZW0pXG4gICAgLnRoZW4oY3J1ZCA9PntcbiAgICAgICRzY29wZS5jcnVkcy5wdXNoKGNydWQpO1xuICAgICAgJHNjb3BlLm5ld0l0ZW0gPSB7fTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnI9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3I6IFwiLCBlcnIgKTtcbiAgICB9KTtcbiAgfVxuXG5cbiAgJHNjb3BlLmRlbGV0ZUNydWQgPSAoaW5kLCBjcnVkKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImNydWQ6XCIsIGNydWQpXG4gICAgQ3J1ZC5kZWxldGVDcnVkKGNydWQuX2lkKVxuICAgIC50aGVuKGNydWQgPT4ge1xuICAgICAgJHNjb3BlLmNydWRzLnNwbGljZShpbmQsMSk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycm9yOiBcIiwgZXJyICk7XG4gICAgfSk7XG4gIH1cblxuICAkc2NvcGUuc2hvd1VwZGF0ZUZvcm0gPSAoaW5kZXgsIGNydWQpID0+e1xuICAgIGNvbnNvbGUubG9nKFwiaW5kZXg6IFwiLCBpbmRleCk7XG4gICAgY29uc29sZS5sb2coXCJjcnVkOiBcIiwgY3J1ZCk7XG4gICAgJHNjb3BlLnNob3dVcGRhdGUgPXRydWU7XG4gICAgJHNjb3BlLnVwZGF0ZUl0ZW0gPSBjcnVkO1xuICAgICRzY29wZS51cGRhdGVJbmRleCA9IGluZGV4O1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZUNydWQ9ICgpID0+e1xuICAgICRzY29wZS5zaG93VXBkYXRlID1mYWxzZTtcbiAgICBDcnVkLnVwZGF0ZUNydWQoJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCAkc2NvcGUudXBkYXRlSXRlbSlcbiAgICAudGhlbihjcnVkID0+e1xuICAgICAgY29uc29sZS5sb2coXCJ1cGRhdGUgYXB0OlwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0uX2lkLCBcIiAsIFwiICwgJHNjb3BlLnVwZGF0ZUl0ZW0pO1xuICAgIH0pXG4gICAgLmNhdGNoKGVycj0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnJvcjogXCIsIGVyciApO1xuICAgIH0pO1xuICB9XG5cbn0pO1xuIiwiXG4ndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCwgJHJvb3RTY29wZSkge1xuICBjb25zb2xlLmxvZygnbG9naW5DdHJsIScpO1xuXG4gICRzY29wZS5sb2dpbiA9ICgpID0+IHtcbiAgICAgICRhdXRoLmxvZ2luKCRzY29wZS51c2VyKVxuICAgICAgLnRoZW4ocmVzID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcInJlczogXCIsIHJlcyk7XG4gICAgICAgIC8vJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHJlcy5kYXRhO1xuICAgICAgICAkc3RhdGUuZ28oJ3Byb2ZpbGUnKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxubGV0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuY29udHJvbGxlcignbWFpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRzdGF0ZSwgJGF1dGgsICRyb290U2NvcGUpIHtcbiAgY29uc29sZS5sb2coJ21haW5DdHJsIScpO1xuXG4gICRyb290U2NvcGUuY3VycmVudFVzZXI7XG5cbiAgJHNjb3BlLmlzQXV0aGVudGljYXRlZCA9ICgpID0+ICRhdXRoLmlzQXV0aGVudGljYXRlZCgpO1xuXG4gICRzY29wZS5sb2dvdXQgPSAoKSA9PiB7XG4gICAgJGF1dGgubG9nb3V0KCk7XG4gICAgJHN0YXRlLmdvKCdob21lJyk7XG4gIH07XG5cbiAgJHNjb3BlLmF1dGhlbnRpY2F0ZSA9IHByb3ZpZGVyID0+IHtcbiAgICAkYXV0aC5hdXRoZW50aWNhdGUocHJvdmlkZXIpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgfTtcbn0pO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG5sZXQgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5jb250cm9sbGVyKCdwcm9maWxlQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgUHJvZmlsZSwgUHJvZmlsZUJ5SUQsICRzdGF0ZSwgVXNlciwgJHJvb3RTY29wZSkge1xuICBcbiAgY29uc29sZS5sb2coJ3Byb2ZpbGVDdHJsIScpO1xuXG4gICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBQcm9maWxlO1xuXG4gICRzY29wZS51c2VyID0gUHJvZmlsZUJ5SUQgfHwgUHJvZmlsZTtcblxuICBjb25zb2xlLmxvZyhcInVzZXI6XCIsICRzY29wZS51c2VyICk7XG4gIGNvbnNvbGUubG9nKFwiY3VycnVzZXI6XCIsICRyb290U2NvcGUuY3VycmVudFVzZXIgKTtcblxuICAkc2NvcGUuc2hvd2Rpc3BsYXlOYW1lRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZWRpc3BsYXlOYW1lID0gKCkgPT4ge1xuICAgICRzY29wZS5kaXNwbGF5TmFtZUZvcm0gPSBmYWxzZTtcbiAgICAkc2NvcGUudXNlci5kaXNwbGF5TmFtZSA9ICRzY29wZS5uZXdJdGVtLmRpc3BsYXlOYW1lO1xuICAgIFVzZXIudXBkYXRlUHJvZmlsZSgkc2NvcGUudXNlci5faWQsICRzY29wZS5uZXdJdGVtKVxuICAgICAgLnRoZW4ocHJvZmlsZSA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJwcm9maWxlOlwiLCBwcm9maWxlKTtcbiAgICAgICAgJHNjb3BlLm5ld0l0ZW0uZGlzcGxheU5hbWUgPSAnJztcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICAgIH0pXG4gIH1cblxuICAkc2NvcGUuY2FuY2VsZGlzcGxheU5hbWUgPSAoKSA9PntcbiAgICAkc2NvcGUudXNlcm5hbWVGb3JtID0gdHJ1ZTtcbiAgICAkc2NvcGUubmV3SXRlbS5kaXNwbGF5TmFtZSA9ICcnO1xuICB9XG5cbi8vcGhvdG9cbiAgJHNjb3BlLnNob3dQaWN0dXJlRm9ybSA9ICgpID0+e1xuICAgIGNvbnNvbGUubG9nKFwic2hvdyBmb3JtXCIpO1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICB9XG5cbiAgJHNjb3BlLnVwZGF0ZVBpY3R1cmUgPSAoKSA9PiB7XG4gICAgJHNjb3BlLnBob3RvRm9ybSA9IGZhbHNlO1xuICAgIGNvbnNvbGUubG9nKFwiJHN0YXRlLmN1cnJlbnQ6IFwiLCAkc3RhdGUuY3VycmVudCk7XG4gICAgJHNjb3BlLnVzZXIucHJvZmlsZUltYWdlID0gJHNjb3BlLm5ld0l0ZW0ucHJvZmlsZUltYWdlO1xuICAgIGNvbnNvbGUubG9nKFwiJHNjb3BlLm5ld0l0ZW06XCIsICRzY29wZS5uZXdJdGVtKTtcbiAgICBVc2VyLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLnVzZXIuX2lkLCAkc2NvcGUubmV3SXRlbSlcbiAgICAgIC50aGVuKHByb2ZpbGUgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZTpcIiwgcHJvZmlsZSk7XG4gICAgICAgICRzY29wZS5uZXdJdGVtLnByb2ZpbGVJbWFnZSA9ICcnO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgfVxuXG4gICRzY29wZS5jYW5jZWxQaG90b1VybCA9ICgpID0+e1xuICAgICRzY29wZS5waG90b0Zvcm0gPSB0cnVlO1xuICAgICRzY29wZS5uZXdJdGVtLnBob3RvVXJsID0gJyc7XG4gIH1cblxuXG4gICRzY29wZS5kZWxldGVBY2NvdW50ID0gKHVzZXIpID0+e1xuICAgIC8vYWRkIHN3YWxcbiAgICBjb25zb2xlLmxvZyh1c2VyLl9pZCk7XG4gICAgVXNlci5kZWxldGVBY2NvdW50KHVzZXIuX2lkKVxuICAgICAgLnRoZW4oKVxuICAgICAgLmNhdGNoKGVyciA9PntcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnI6IFwiLCBlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuXG59KTsiLCIndXNlIHN0cmljdCc7XG5cbmxldCBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHN0YXRlLCAkYXV0aCkge1xuICBjb25zb2xlLmxvZygncmVnaXN0ZXJDdHJsIScpO1xuXG4gICRzY29wZS5yZWdpc3RlciA9ICgpID0+IHtcbiAgICBpZigkc2NvcGUudXNlci5wYXNzd29yZCAhPT0gJHNjb3BlLnVzZXIucGFzc3dvcmQyKXtcbiAgICAgICRzY29wZS51c2VyLnBhc3N3b3JkID0gbnVsbDtcbiAgICAgICRzY29wZS51c2VyLnBhc3N3b3JkMiA9IG51bGw7XG4gICAgICBhbGVydCgnUGFzc3dvcmRzIG11c3QgbWF0Y2ghJyk7XG4gICAgfWVsc2V7XG4gICAgICAkYXV0aC5zaWdudXAoJHNjb3BlLnVzZXIpXG4gICAgICAudGhlbihyZXMgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwicmVzOiBcIiwgcmVzKTtcbiAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT57XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgICAgfSlcbiAgICB9XG4gIH07XG59KTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnbXlBcHAnKTtcblxuYXBwLmNvbnRyb2xsZXIoJ3VzZXJzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJCRzdGF0ZSwgJHN0YXRlLCBVc2VyKSB7XG4gIGNvbnNvbGUubG9nKCd1c2Vyc0N0cmwhJyk7XG5cbiAgdmFyIHVzZXJQcm9taXNlID0gVXNlci5nZXRBbGwoKTtcbiAgY29uc29sZS5sb2coXCJ1c2VyUHJvbWlzZTpcIiwgdXNlclByb21pc2UpO1xuICB1c2VyUHJvbWlzZS50aGVuKFxuICAgIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdC5kYXRhKTtcbiAgICAgICAkc2NvcGUudXNlckZlZWQgPSByZXN1bHQuZGF0YTtcbiAgICB9KTtcblxuXG5cbn0pOyIsIid1c2Ugc3RyaWN0JztcblxudmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdteUFwcCcpO1xuXG5hcHAuc2VydmljZSgnQ3J1ZCcsIGZ1bmN0aW9uKCRodHRwLCAkcSl7XG5cbiAgdGhpcy5nZXRBbGwgPSAoKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NydWRzJyk7XG4gIH1cblxuICB0aGlzLmdldEJ5SWQgPSBpZCA9PntcbiAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL2NydWRzLyR7aWR9YCk7XG4gIH1cblxuICB0aGlzLmFkZENydWQ9IChjcnVkKSA9PntcbiAgICByZXR1cm4gJGh0dHAucG9zdChgL2FwaS9jcnVkc2AsIGNydWQpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7ICAgXG4gICAgICAgIGNvbnNvbGUubG9nKCdlcnI6JywgZXJyKTtcbiAgICAgIH0pXG4gICAgfTtcblxuICB0aGlzLmRlbGV0ZUNydWQgPSAoaWQpID0+e1xuICAgIHJldHVybiAkaHR0cC5kZWxldGUoYC9hcGkvY3J1ZHMvJHtpZH1gKVxuICAgICAgLnRoZW4oICgpID0+IHtcbiAgICAgICAgcmV0dXJuICRxLnJlc29sdmUoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZXJyID0+IHsgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2VycjonLCBlcnIpO1xuICAgICAgfSlcbiAgICB9O1xuXG4gIHRoaXMudXBkYXRlQ3J1ZCA9IChpZCwgY3J1ZCkgPT57XG4gICAgICByZXR1cm4gJGh0dHAucHV0KGAvYXBpL2NydWRzLyR7aWR9YCwgY3J1ZClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKGNydWQpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgICB9KVxuICAgIH07XG5cbn0pO1xuXG4vL2luIHJlc2lkZW50cyBSZXNpZGVudC5nZXRBbGwoKVxuLy8gICAgICAgICAgICAgICAgLnRoZW4ocmVzaWRlbnRzID0+e30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ215QXBwJyk7XG5cbmFwcC5zZXJ2aWNlKCdVc2VyJywgZnVuY3Rpb24oJGh0dHAsICRxKSB7XG5cbiAgdGhpcy5wcm9maWxlID0gKCkgPT4ge1xuICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcHJvZmlsZScpXG4gICAgICAudGhlbihyZXMgPT4ge1xuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZShyZXMuZGF0YSk7XG4gICAgICB9KTtcbiAgfTtcblxuICB0aGlzLmdldFByb2ZpbGUgPSAoaWQpID0+e1xuICAgICByZXR1cm4gJGh0dHAuZ2V0KGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT57XG4gICAgICBjb25zb2xlLmxvZyhcImVycjpcIiwgZXJyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRoaXMuZ2V0QWxsID0gKCkgPT57XG4gICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpO1xuICB9XG5cbiAgdGhpcy51cGRhdGVQcm9maWxlID0gKGlkLCBwcm9maWxlT2JqKSA9PntcbiAgICBjb25zb2xlLmxvZyhcImhlcmVcIik7XG4gICAgY29uc29sZS5sb2coaWQgLCBcIiBcIiAscHJvZmlsZU9iaik7XG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7aWR9YCwgIHByb2ZpbGVPYmopXG4gICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZXMuZGF0YVwiLCByZXMuZGF0YSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwicHJvZmlsZU9ialwiLCBwcm9maWxlT2JqKTtcblxuICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKGVyciA9PntcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyOlwiLCBlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgdGhpcy5kZWxldGVBY2NvdW50ID0gKGlkKSA9PntcbiAgICByZXR1cm4gJGh0dHAuZGVsZXRlKGAvYXBpL3VzZXJzL3Byb2ZpbGUvJHtpZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goZXJyID0+e1xuICAgICAgY29uc29sZS5sb2coXCJlcnI6XCIsIGVycik7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLmFkZFdhbGxQb3N0VG9Vc2VyID0gKHVzZXJJZCwgcG9zdElkKSA9PntcbiAgICBjb25zb2xlLmxvZyhcInVzZXJJZDogXCIsdXNlcklkICxcIiBwb3N0SWQ6IFwiLCBwb3N0SWQpXG4gICAgcmV0dXJuICRodHRwLnB1dChgL2FwaS91c2Vycy9wcm9maWxlLyR7dXNlcklkfS9hZGRXYWxsUG9zdC8ke3Bvc3RJZH1gKVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiAkcS5yZXNvbHZlKHJlcy5kYXRhKTtcbiAgICB9KVxuICAgIC5jYXRjaChlcnIgPT4geyAgIFxuICAgICAgICBjb25zb2xlLmxvZygnZXJyOicsIGVycik7XG4gICAgfSlcbiAgfTsgXG5cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
